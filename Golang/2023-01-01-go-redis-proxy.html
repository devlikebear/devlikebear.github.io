<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>go-redis Proxy 모듈 구현 | devlikebear&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="devlikebear&#39;s blog">
    
    <link rel="preload" href="/assets/css/0.styles.d6ad21ed.css" as="style"><link rel="preload" href="/assets/js/app.f27f7ffb.js" as="script"><link rel="preload" href="/assets/js/2.99652857.js" as="script"><link rel="preload" href="/assets/js/9.d263766e.js" as="script"><link rel="prefetch" href="/assets/js/10.ac382152.js"><link rel="prefetch" href="/assets/js/3.736b96b9.js"><link rel="prefetch" href="/assets/js/4.cef88356.js"><link rel="prefetch" href="/assets/js/5.040814f7.js"><link rel="prefetch" href="/assets/js/6.3e274d8c.js"><link rel="prefetch" href="/assets/js/7.cee813c9.js"><link rel="prefetch" href="/assets/js/8.0ce128f6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d6ad21ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">devlikebear's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/devlikebear" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/devlikebear" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HOME</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Golang</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Golang/2023-01-01-go-redis-proxy.html" aria-current="page" class="active sidebar-link">go-redis Proxy 모듈 구현</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Golang/2023-01-01-go-redis-proxy.html#go-redis-proxy를-구현하는-이유" class="sidebar-link">go-redis Proxy를 구현하는 이유</a></li><li class="sidebar-sub-header"><a href="/Golang/2023-01-01-go-redis-proxy.html#go-redis-의존성-추가" class="sidebar-link">go-redis 의존성 추가</a></li><li class="sidebar-sub-header"><a href="/Golang/2023-01-01-go-redis-proxy.html#테스트-코드-작성" class="sidebar-link">테스트 코드 작성</a></li><li class="sidebar-sub-header"><a href="/Golang/2023-01-01-go-redis-proxy.html#redis-proxy-인터페이스-정의" class="sidebar-link">Redis Proxy 인터페이스 정의</a></li><li class="sidebar-sub-header"><a href="/Golang/2023-01-01-go-redis-proxy.html#proxy-인터페이스-구현" class="sidebar-link">Proxy 인터페이스 구현</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Jekyll</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VuePress</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="go-redis-proxy를-구현하는-이유"><a href="#go-redis-proxy를-구현하는-이유" class="header-anchor">#</a> go-redis Proxy를 구현하는 이유</h2> <p>go-redis Proxy는 왜 작성할까요?</p> <p>그냥 바로 go-redis 패키지를 import해서 사용해도 됩니다.</p> <p>하지만 저는 가급적 3rd-party 패키지에 의존하는 코드를 구현하는 코드에 드러내는 걸 좋아하지 않습니다.</p> <p>이유는 이후 해당 패키지를 다른 패키지로 변경하거나, 버전업의 이유로 업그레이드를 할 때, 직접 import한 모듈이 여기저기 흩어져 있을 경우 수정하기가 어렵기 때문입니다.</p> <p>Proxy 패턴을 사용해 실제 모듈은 Proxy 모듈의 뒤로 숨겨두고 사용은 Proxy 인터페이스를 사용하는 방식으로 작성합니다.</p> <h2 id="go-redis-의존성-추가"><a href="#go-redis-의존성-추가" class="header-anchor">#</a> go-redis 의존성 추가</h2> <p>redis 서버 버전이 7 이상일 경우 goredis는 v9을 사용해야 합니다.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>go get github.com/go-redis/redis/v9
</code></pre></div><p>6 이하일 경우에는 v8을 사용합니다.</p> <h2 id="테스트-코드-작성"><a href="#테스트-코드-작성" class="header-anchor">#</a> 테스트 코드 작성</h2> <p>먼저 테스트코드를 작성합니다.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> redisproxy_test

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;testing&quot;</span>
	<span class="token string">&quot;time&quot;</span>

	<span class="token string">&quot;github.com/stretchr/testify/assert&quot;</span>
	<span class="token string">&quot;www.devforest.net/pkg/redisproxy&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
	ctx        context<span class="token punctuation">.</span>Context
	expiration time<span class="token punctuation">.</span>Duration
	key<span class="token punctuation">,</span> value <span class="token builtin">string</span>
	redis      redisproxy<span class="token punctuation">.</span>Proxy
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ctx <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	expiration <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second
	key<span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bar&quot;</span>

	conf <span class="token operator">:=</span> <span class="token operator">&amp;</span>redisproxy<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
		Addr<span class="token punctuation">:</span> <span class="token string">&quot;localhost:6379&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	redisproxy<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span>
	redis <span class="token operator">=</span> redisproxy<span class="token punctuation">.</span><span class="token function">GetRedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestGet</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// given</span>
	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> redis<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expiration<span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token comment">// when</span>
	v<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>

	<span class="token comment">// then</span>
	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> v<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestSet</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// given</span>
	redis<span class="token punctuation">.</span><span class="token function">Del</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
	assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> redisproxy<span class="token punctuation">.</span>ErrNotFound<span class="token punctuation">,</span> err<span class="token punctuation">)</span>

	<span class="token comment">// when</span>
	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> redis<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expiration<span class="token punctuation">)</span><span class="token punctuation">)</span>
	v<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>

	<span class="token comment">// then</span>
	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> v<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Get()과 Set() 기능을 테스트하는 코드를 작성합니다.</p> <h2 id="redis-proxy-인터페이스-정의"><a href="#redis-proxy-인터페이스-정의" class="header-anchor">#</a> Redis Proxy 인터페이스 정의</h2> <p>redisproxy.Proxy는 다음과 같이 Redis 인터페이스를 정의합니다.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> redisproxy

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;errors&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
	<span class="token comment">// ErrNotFound 에러</span>
	ErrNotFound <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;not found&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">// Proxy Redis Proxy 인터페이스 정의</span>
<span class="token keyword">type</span> Proxy <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token comment">// Get 키에 해당하는 값을 조회</span>
	<span class="token function">Get</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

	<span class="token comment">// Set 키에 해당하는 값을 저장</span>
	<span class="token comment">// 유효시간을 설정할 경우 해당 시간 이후 삭제된다.</span>
	<span class="token function">Set</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value <span class="token builtin">string</span><span class="token punctuation">,</span> expiration time<span class="token punctuation">.</span>Duration<span class="token punctuation">)</span> <span class="token builtin">error</span>

	<span class="token comment">// Del 지정된 키들 삭제</span>
	<span class="token comment">// 성공할 경우 삭제된 키의 개수를 반환한다.</span>
	<span class="token function">Del</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> keys <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>지금은 단순히 키&amp;값을 저장하고 조회하는 기능만 있으면 되기때문에 Get(), Set(), Del() 함수만 포함하지만, 추후 해시를 다룰 필요가 있을 경우 Proxy 인터페이스를 확장할 예정입니다.</p> <h2 id="proxy-인터페이스-구현"><a href="#proxy-인터페이스-구현" class="header-anchor">#</a> Proxy 인터페이스 구현</h2> <p>Proxy 인터페이스를 구현하는 코드를 다음과 같이 작성합니다.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> redisproxy

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;sync&quot;</span>
	<span class="token string">&quot;time&quot;</span>

	<span class="token string">&quot;github.com/go-redis/redis/v9&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
	once       sync<span class="token punctuation">.</span>Once
	redisProxy Proxy
<span class="token punctuation">)</span>

<span class="token keyword">type</span> proxy <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	client <span class="token operator">*</span>redis<span class="token punctuation">.</span>Client
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Init</span><span class="token punctuation">(</span>conf <span class="token operator">...</span><span class="token operator">*</span>Config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	once<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">{</span>
			<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;not given redis config&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		redisConf <span class="token operator">:=</span> conf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

		client <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>redis<span class="token punctuation">.</span>Options<span class="token punctuation">{</span>
			Addr<span class="token punctuation">:</span>     redisConf<span class="token punctuation">.</span>Addr<span class="token punctuation">,</span>
			Password<span class="token punctuation">:</span> redisConf<span class="token punctuation">.</span>Password<span class="token punctuation">,</span>
			DB<span class="token punctuation">:</span>       redisConf<span class="token punctuation">.</span>DB<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		redisProxy <span class="token operator">=</span> <span class="token operator">&amp;</span>proxy<span class="token punctuation">{</span>
			client<span class="token punctuation">:</span> client<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">GetRedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Proxy <span class="token punctuation">{</span>
	<span class="token keyword">return</span> redisProxy
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>clt proxy<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	strCmd <span class="token operator">:=</span> clt<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
	<span class="token keyword">if</span> strCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> strCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> redis<span class="token punctuation">.</span>Nil <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> ErrNotFound
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> strCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> strCmd<span class="token punctuation">.</span><span class="token function">Val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>clt proxy<span class="token punctuation">)</span> <span class="token function">Set</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value <span class="token builtin">string</span><span class="token punctuation">,</span> expiration time<span class="token punctuation">.</span>Duration<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	statusCmd <span class="token operator">:=</span> clt<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expiration<span class="token punctuation">)</span>
	<span class="token keyword">if</span> statusCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> statusCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>clt proxy<span class="token punctuation">)</span> <span class="token function">Del</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> keys <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	intCmd <span class="token operator">:=</span> clt<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Del</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> keys<span class="token operator">...</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> intCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> intCmd<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token function">int</span><span class="token punctuation">(</span>intCmd<span class="token punctuation">.</span><span class="token function">Val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Redis 서버에 연결할 때 사용할 설정을 다루는 Config도 go-redis를 노출하지 않기 위해 다음과 같이 Config 구조체를 만들어 정의합니다.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> redisproxy

<span class="token comment">// Config Redis 서버 연결 설정</span>
<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Addr     <span class="token builtin">string</span>	<span class="token comment">// 서버 주소. 예) localhost:6379</span>
	Password <span class="token builtin">string</span>	<span class="token comment">// 서버 연결 암호</span>
	DB       <span class="token builtin">int</span>	<span class="token comment">// DB 번호</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/" class="prev router-link-active">
        DevLikeBear's Blog
      </a></span> <span class="next"><a href="/Jekyll/2022-12-29-jekyll-github-blog.html">
        Jekyll과 Github Page로 블로그 구축하기
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f27f7ffb.js" defer></script><script src="/assets/js/2.99652857.js" defer></script><script src="/assets/js/9.d263766e.js" defer></script>
  </body>
</html>
